vulnerability_register:
  metadata:
    last_updated: 2026-02-19
    policy: All vulnerabilities must be documented with justification and timeline
    note: Initial vulnerability register for Top AI Ideas project
    categories:
      false_positive:
        description: Vulnerability detected by the tool but not applicable in our context
        examples:
          - Test code that is never executed in production
          - Specific configuration that neutralizes the risk
          - Tool scan limitation
      accepted_risk:
        description: Vulnerability acknowledged but risk is acceptable in current context
        examples:
          - Development environment only
          - Isolated container environment
          - Compensating controls in place
      planned_mitigation:
        description: Vulnerability will be addressed in planned timeframe
        examples:
          - Dockerfile hardening (non-root users)
          - Dependency updates
          - Configuration improvements
      technical_debt:
        description: Technical debt that will be addressed during refactoring
        examples:
          - Legacy code patterns
          - Architecture improvements
          - Security framework upgrades

  vulnerabilities:
    # Hono JWT Auth Middleware - Missing aud (Audience) verification
    CVE-2025-62610_api_hono_4.9.10:
      category: planned_mitigation
      risk: HIGH
      description: Hono JWT Auth Middleware does not provide built-in aud (Audience) verification option, which can cause confused-deputy / token-mix-up issues when multiple services share the same issuer/keys
      file: api/package.json
      line: 1
      cwe: CWE-285
      owasp: A01:2021
      fix_goal: 1w
      justification: |
        The vulnerability affects JWT authentication middleware in Hono framework.
        Current version: 4.9.10
        Fixed version: 4.10.2
        Risk: HIGH - Can lead to unintended cross-service access if multiple services share issuer/keys
        Mitigation: Update Hono to 4.10.2+ which includes aud verification support
        Impact: Low in current deployment (single API service, no shared JWT issuer), but should be fixed to prevent future issues
      status: resolved
      discovered: 2025-11-06
      fixed_date: 2025-11-06
      fixed_version: 4.10.4

    # Glob CLI Command Injection - npm/node-gyp dependencies
    CVE-2025-64756_api_glob_10.4.5:
      category: planned_mitigation
      risk: HIGH
      description: Glob CLI contains a command injection vulnerability in its -c/--cmd option that allows arbitrary command execution when processing files with malicious names
      file: usr/local/lib/node_modules/npm/node_modules/node-gyp/node_modules/glob/package.json
      line: 1
      cwe: CWE-78
      fix_goal: 1d
      justification: |
        The vulnerability affects the glob CLI tool (command-line interface), not the glob library used in code.
        Location: npm/node-gyp dependencies in Docker base image (node:24-alpine)
        Current version: 10.4.5 (vulnerable)
        Fixed version: 10.5.0 or 11.1.0
        Resolution: Updated npm to latest version, which removed node-gyp's glob dependency. The vulnerability is resolved.
      status: resolved
      discovered: 2025-11-24
      fixed_date: 2025-11-24
      fixed_version: "Resolved by npm update (node-gyp glob dependency removed)"

    CVE-2025-64756_api_glob_11.0.3:
      category: planned_mitigation
      risk: HIGH
      description: Glob CLI contains a command injection vulnerability in its -c/--cmd option that allows arbitrary command execution when processing files with malicious names
      file: usr/local/lib/node_modules/npm/node_modules/glob/package.json
      line: 1
      cwe: CWE-78
      fix_goal: 1d
      justification: |
        The vulnerability affects the glob CLI tool (command-line interface), not the glob library used in code.
        Location: npm dependencies in Docker base image (node:24-alpine)
        Current version: 11.0.3 (vulnerable)
        Fixed version: 11.1.0
        Resolution: Force updated glob in npm's node_modules by downloading glob@11.1.0 and replacing npm's glob directory in Dockerfile.
        Method: npm pack glob@11.1.0, then replace /usr/local/lib/node_modules/npm/node_modules/glob with the patched version.
      status: resolved
      discovered: 2025-11-24
      fixed_date: 2025-11-24
      fixed_version: 11.1.0

    # npm bundled minimatch (build tooling path)
    CVE-2026-26996_api_minimatch_10.1.2:
      category: accepted_risk
      risk: HIGH
      description: minimatch ReDoS vulnerability in npm bundled dependency used by npm CLI glob processing
      file: usr/local/lib/node_modules/npm/node_modules/minimatch/package.json
      line: 1
      cwe: CWE-1333
      fix_goal: 1w
      justification: |
        The vulnerable package is inside npm itself (Node base image tooling), not in API runtime code paths.
        Exposure is limited to build/tooling operations using npm CLI and not to user-request runtime execution.
        Current npm bundle ships minimatch 10.1.2, and direct in-place override introduced npm internal dependency conflicts.
        Temporary exception is accepted while tracking a clean upstream npm/base-image upgrade path.
        Follow-up is explicitly tracked in TODO.md and component lifecycle debt tracking.
      status: accepted_temporary
      discovered: 2026-02-19
      review_due: 2026-02-26
      planned_fix: Upgrade npm/base image when npm bundle includes fixed minimatch and remove this exception after container scan passes
