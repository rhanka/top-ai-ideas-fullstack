# SPEC EVOL - TODO, Steering, Agentic Workflows, Workspace Templates

Status: Draft for roadmap orchestration (2026-02-22)

## 1) Objective
Deliver the product backbone for guided execution in one week (deadline: 2026-03-01):

- TODO management v1.
- Steering mode v1.
- Base autonomous workflow/agent orchestration.
- Workspace multi-template foundation (at least `ai-ideas`, `todo`).

## 2) Scope

In scope:
- Unified task/plan/checkpoint domain model.
- Steering layer to control plan progression and human approval points.
- Workflow template abstraction (`workflow + objects + agents + tools`).
- Runtime selection of workspace template.
- API/UI primitives reusable by web app and plugins.

Out of scope:
- Fully autonomous long-running agents without guardrails.
- Advanced business template packs beyond core foundations.
- Third-party PM integrations (GitHub/Notion/Microsoft) beyond placeholders.

## 3) Existing baseline
Relevant references:
- `spec/SPEC.md`
- `spec/SPEC_CHATBOT.md`
- `spec/TOOLS.md`
- `spec/COLLAB.md`
- `TODO.md` (`Tools de productivitÃ©`, `workflow/object/template`, `steering` items)

Current state summary:
- Chat + tools + queue are available.
- No first-class TODO/plan workflow object with checkpoint lifecycle.
- No explicit steering state machine shared across UI and plugins.

## 4) Target design

### 4.1 Core entities
- `workflow_templates`
  - `id`, `key`, `name`, `version`, `status`, `definition_json`, timestamps.
- `workspace_workflows`
  - selected template per workspace and runtime config.
- `plans`
  - linked to workspace/template/context.
- `plan_steps`
  - ordered steps with status (`todo`, `in_progress`, `blocked`, `done`, `cancelled`).
- `plan_checkpoints`
  - snapshots and rollback anchors.
- `steering_events`
  - explicit steering decisions and rationale.

### 4.2 Steering mode
- Steering is a first-class runtime policy:
  - `manual`: every critical step requires user approval.
  - `hybrid`: low-risk steps auto-advance, critical steps require approval.
  - `auto`: maximum autonomy inside defined safety envelope.
- All steering decisions are logged and replayable.

### 4.3 TODO management v1
- CRUD and ordering of plan steps.
- Multi-step decomposition generated by assistant with explicit confirmation.
- Step-level links to tool runs and artifacts.
- Basic revision cycle: reopen, split, merge, cancel.

### 4.4 Workspace templates v1
- Template catalog with at least two templates:
  - `ai-ideas`
  - `todo`
- Template drives:
  - default objects,
  - default toolsets,
  - default steering profile,
  - onboarding hints.

## 5) Branch plan

- `feat/todo-steering-workflow-core`
  - Core entities, API contracts, and web UI skeleton.
- `feat/workspace-template-catalog`
  - Template registry + workspace assignment + default templates.

## 6) Acceptance criteria

- Users can create/edit/reorder TODO steps and checkpoints.
- Steering mode is visible and enforceable in execution flow.
- Workspace can switch between `ai-ideas` and `todo` templates.
- API contracts are consumable by web app and plugin clients.
- Execution traces show plan -> step -> tool-call linkage.

## 7) Open questions

- `AWT-Q1`: What is the minimum required status taxonomy for W1 without over-design?
- `AWT-Q2`: Which actions are considered critical and must always require approval?
- `AWT-Q3`: Should template changes migrate existing plans automatically or only for new plans?
- `AWT-Q4`: What is the checkpoint retention policy (count/time) per workspace?
- `AWT-Q5`: Is steering profile controlled by workspace admins only, or by each user session?

## 8) Risks

- Overcoupling TODO model with current chat-specific flows.
- Excessive complexity in first iteration of template abstraction.
- Ambiguous approval semantics between steering and RBAC.
